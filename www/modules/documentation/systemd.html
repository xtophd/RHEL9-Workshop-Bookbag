<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: Definitive RHEL9 Workshop (v9.1)</title>
    <link rel="prev" href="webconsole.html">
    <link rel="next" href="firewalld.html">
    <meta name="generator" content="Antora 3.1.7">
    <link rel="stylesheet" href="../../_/css/site.css">
<link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img
          src="../../_/img/header_logo.png" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" href="../..">Definitive RHEL9 Workshop (v9.1)</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Books</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">CheatSheets</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">CheatSheet A</a>
            <a class="navbar-item" href="#">CheatSheet B</a>
            <a class="navbar-item" href="#">CheatSheet C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Upcoming Events</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Event A</a>
            <a class="navbar-item" href="#">Event B</a>
            <a class="navbar-item" href="#">Event C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Tutorial A</a>
            <a class="navbar-item" href="#">Tutorial B</a>
            <a class="navbar-item" href="#">Tutorial C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="modules" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html" class=" query-params-link">Default Title</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../overview.html">Workshop Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="webconsole.html">Web Console (cockpit)</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="systemd.html">Service Management (systemd)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="firewalld.html">Firewall Management (firewalld)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="nftables.html">Firewall Rules (nf-tables)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ebpf.html">eBPF Tracing (bcc-tools)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="podman.html">Containers Management (podman)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="buildah.html">Containers Dev (buildah)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="image-builder.html">Image Builder (composer-cli)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="virtualization.html">Virtualization (kvm,libvirt)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="tlog.html">Session Logging (tlog)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="lvm-vdo.html">Data Optimization (lvm,vdo)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="stratis.html">Storage Management (stratis)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="kpatch.html">Kernel Live Patching (kpatch)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="boom-kernel-parms.html">Managing GRUB2 with Boom</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="leapp.html">LEAPP In-Place Upgrades</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Default Title</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Default Title</span>
      <ul class="versions">
        <li class="version is-current">
          <a href="../index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../connection.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Default Title</a></li>
    <li><a href="systemd.html">Service Management (systemd)</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///Users/jmaltin/Development/RHEL9-Workshop-Showroom/content/modules/ROOT/pages/documentation/systemd.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<article class="doc">
<div class="sect1">
<h2 id="_introduction_to_systemd"><a class="anchor" href="#_introduction_to_systemd"></a>Introduction to systemd</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Systemd is the "init" system for RHEL 9 (and 8 and 7 for that matter).  Long ago it replaced Upstart, the SysV "init" system used in releases of RHEL 6.x and older.  Systemd is more than just a facility to bring up user space, it is a system manager that offers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>service parallelization</p>
</li>
<li>
<p>socket and D-Bus activation</p>
</li>
<li>
<p>on-demand starting of services</p>
</li>
<li>
<p>track services and child processes via cgroups</p>
</li>
<li>
<p>and much more</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started"><a class="anchor" href="#_getting_started"></a>Getting Started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For these exercises, you will be using the host <code>node1</code> as user <code>root</code>.</p>
</div>
<div class="paragraph">
<p>From host <code>bastion</code>, ssh to <code>node1</code>.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">ssh node1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use <code>sudo</code> to elevate your privileges.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">[[ "$UID" == 0 ]] || sudo -i</code></pre>
</div>
</div>
<div class="paragraph">
<p>Verify that you are on the right host for these exercises.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">workshop-systemd-checkhost.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>You are now ready to proceed with these exercises.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_core_concepts"><a class="anchor" href="#_core_concepts"></a>Core Concepts</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_units"><a class="anchor" href="#_units"></a>Units</h3>
<div class="paragraph">
<p>The fundamental building block that systemd manages is called a "unit".  A "unit" can describe different types of objects, but the most common type is a "service".</p>
</div>
<div class="paragraph">
<p>A "unit file" is the configuration file that describes a unit and tells systemd what dependencies exist and how to start, stop and monitor the object.</p>
</div>
<div class="paragraph">
<p>"unit files" are stored in 2 different directories.  One location is reserved for the default configurations as shipped by Red Hat and the other is for customization by the local administrators.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Red Hat unit files:    /usr/lib/systemd/system/&#8230;&#8203;</p>
</li>
<li>
<p>Customizations:        /etc/systemd/system/&#8230;&#8203;</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_targets"><a class="anchor" href="#_targets"></a>Targets</h3>
<div class="paragraph">
<p>systemd has a concept similar to SysV init runlevels, called targets.  systemd will boot to the “default target” which can be configured using the systemctl set-default command.  Some common targets and their equivalent SysV runlevels are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>multi-user.target == runlevel 3</p>
</li>
<li>
<p>graphical.target == runlevel 5</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s view the current default target.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">systemctl get-default</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">multi-user.target</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_services"><a class="anchor" href="#_services"></a>Services</h3>
<div class="paragraph">
<p>As mentioned above, systemd has another concept called a service.  A service is a type of unit which defines the traditional daemon or process.  Now let us look at what services are running on the system:</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">systemctl -t service | head -n 15</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">UNIT                               LOAD   ACTIVE SUB     DESCRIPTION
auditd.service                     loaded active running Security Auditing Service
chronyd.service                    loaded active running NTP client/server
cloud-config.service               loaded active exited  Apply the settings specified in cloud-config
cloud-final.service                loaded active exited  Execute cloud user/final scripts
cloud-init-local.service           loaded active exited  Initial cloud-init job (pre-networking)
cloud-init.service                 loaded active exited  Initial cloud-init job (metadata service crawler)
crond.service                      loaded active running Command Scheduler
dbus-broker.service                loaded active running D-Bus System Message Bus
dracut-shutdown.service            loaded active exited  Restore /run/initramfs on shutdown
firewalld.service                  loaded active running firewalld - dynamic firewall daemon
getty@tty1.service                 loaded active running Getty on tty1
import-state.service               loaded active exited  Import network configuration from initramfs
irqbalance.service                 loaded active running irqbalance daemon
kdump.service                      loaded active exited  Crash recovery kernel arming</pre>
</div>
</div>
<div class="paragraph">
<p>Next let&#8217;s view all of the services available (ie: everything installed, running or not) on the system. The following command is similar to the older chkconfig --list as it will show both enabled and disabled services:</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">systemctl --no-pager list-unit-files -t service</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">UNIT FILE                                  STATE           VENDOR PRESET
auditd.service                             enabled         enabled
autovt@.service                            alias           -
chrony-wait.service                        disabled        disabled
chronyd.service                            enabled         enabled
cloud-config.service                       enabled         disabled
cloud-final.service                        enabled         disabled
cloud-init-local.service                   enabled         disabled
cloud-init.service                         enabled         disabled
cockpit-motd.service                       static          -
cockpit-wsinstance-http.service            static          -
cockpit-wsinstance-https-factory@.service  static          -
cockpit-wsinstance-https@.service          static          -
cockpit.service                            static          -
console-getty.service                      disabled        disabled
container-getty@.service                   static          -

...&lt;output truncated&gt;...</pre>
</div>
</div>
<div class="paragraph">
<p>The state will  be enabled, disabled, static, or masked.  Static indicates that the unit file does not contain an "install" section used to enable the unit.  In this case, the unit typically performs a one-off action or is used as a dependency of another unit and should not be run by itself.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_analyzing_system_startup"><a class="anchor" href="#_analyzing_system_startup"></a>Analyzing System Startup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s collect some initial data about the boot process</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">systemd-analyze</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">Startup finished in 2.463s (kernel) + 3.527s (initrd) + 22.967s (userspace) = 28.957s
multi-user.target reached after 8.257s in userspace.</pre>
</div>
</div>
<div class="paragraph">
<p>Next let&#8217;s inspect further details about all running units, ordered by the time they took to initialize.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">systemd-analyze blame | head -n 15</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">14.897s kdump.service
 5.793s sys-devices-platform-serial8250-tty-ttyS2.device
 5.793s dev-ttyS2.device
 5.792s dev-ttyS3.device
 5.792s sys-devices-platform-serial8250-tty-ttyS3.device
 5.787s dev-ttyS0.device
 5.787s sys-devices-pnp0-00:04-tty-ttyS0.device
 5.778s dev-ttyS1.device
 5.778s sys-devices-platform-serial8250-tty-ttyS1.device
 5.756s sys-module-configfs.device
 5.558s dev-disk-by\x2did-nvme\x2dAmazon_Elastic_Block_Store_vol0a6e8f9e6b883a484\x2dpart2.device
 5.558s dev-disk-by\x2dpartuuid-68b2905b\x2ddf3e\x2d4fb3\x2d80fa\x2d49d1e773aa33.device
 5.558s dev-disk-by\x2duuid-7B77\x2d95E7.device
 5.558s dev-disk-by\x2did-nvme\x2dnvme.1d0f\x2d766f6c3061366538663965366238383361343834\x2d416d617a6f6e20456c617374696320426c6f
636b2053746f7265\x2d00000001\x2dpart2.device
 5.558s dev-disk-by\x2dpath-pci\x2d0000:00:04.0\x2dnvme\x2d1\x2dpart2.device</pre>
</div>
</div>
<div class="paragraph">
<p>This helps to learn the “cost” of some of the default services.  To speed up boot-time, unnecessary services could potentially be removed or disabled.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_exercise_install_a_lamp_stack"><a class="anchor" href="#_exercise_install_a_lamp_stack"></a>Exercise : Install a LAMP Stack</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_install_packages"><a class="anchor" href="#_install_packages"></a>Install Packages</h3>
<div class="paragraph">
<p>Now that we have a good idea of what’s installed on our system, let’s get a basic lamp stack up and running.</p>
</div>
<div class="paragraph">
<p>Let us install some packages.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">dnf install -y httpd mariadb-server mariadb</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">...snip ...
Package httpd-2.4.53-11.el9_2.5.x86_64 is already installed.
Package mariadb-server-3:10.5.16-2.el9_0.x86_64 is already installed.
Package mariadb-3:10.5.16-2.el9_0.x86_64 is already installed.
Dependencies resolved.
Nothing to do.
Complete!</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_enable_services"><a class="anchor" href="#_enable_services"></a>Enable Services</h3>
<div class="paragraph">
<p>Now it&#8217;s time to enable the relevant system services.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The "enable --now" syntax was introduced in a recent release of RHEL 7 and of course is now availbale in RHEL 8 and RHEL 9.  The option permanently enables AND immediately starts the specified services in a single command.
</td>
</tr>
</table>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">systemctl enable --now httpd mariadb</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">Created symlink /etc/systemd/system/multi-user.target.wants/httpd.service → /usr/lib/systemd/system/httpd.service.
Created symlink /etc/systemd/system/mysql.service → /usr/lib/systemd/system/mariadb.service.
Created symlink /etc/systemd/system/mysqld.service → /usr/lib/systemd/system/mariadb.service.
Created symlink /etc/systemd/system/multi-user.target.wants/mariadb.service → /usr/lib/systemd/system/mariadb.service.</pre>
</div>
</div>
<div class="paragraph">
<p>Now let&#8217;s check the status.  You should see two separate sections in the output, one for httpd and one for mariadb.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">systemctl --no-pager status httpd mariadb</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">● httpd.service - The Apache HTTP Server
     Loaded: loaded (/usr/lib/systemd/system/httpd.service; enabled; preset: disabled)
     Active: active (running) since Mon 2023-09-25 14:53:46 UTC; 11s ago
       Docs: man:httpd.service(8)
   Main PID: 36188 (httpd)
     Status: "Total requests: 0; Idle/Busy workers 100/0;Requests/sec: 0; Bytes served/sec:   0 B/sec"
      Tasks: 213 (limit: 22480)
     Memory: 33.3M
        CPU: 105ms
     CGroup: /system.slice/httpd.service
             ├─36188 /usr/sbin/httpd -DFOREGROUND
             ├─36233 /usr/sbin/httpd -DFOREGROUND
             ├─36238 /usr/sbin/httpd -DFOREGROUND
             ├─36239 /usr/sbin/httpd -DFOREGROUND
             └─36252 /usr/sbin/httpd -DFOREGROUND
...&lt;output truncated&gt;...</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_enable_firewall"><a class="anchor" href="#_enable_firewall"></a>Enable Firewall</h3>
<div class="paragraph">
<p>Last but not least, you need to enable a firewall port.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">firewall-cmd --add-service=http</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">success</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_exercise_customize_default_services"><a class="anchor" href="#_exercise_customize_default_services"></a>Exercise: Customize Default Services</h2>
<div class="sectionbody">
<div class="paragraph">
<p>systemd controls more than daemons or services. For this lab, we will primarily be working with service units but it&#8217;s important to know that systemd is handling the dependencies between other types: sockets, timers, mounts, swap, slices, etc.</p>
</div>
<div class="paragraph">
<p>Unit files are stored in one of three places:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>'/usr/lib/systemd/system' - default configs that ship with the RHEL and are updated by regular maintenance</p>
</li>
<li>
<p>'/etc/systemd/system' - custom configs that persist and replace (or augment) default configs</p>
</li>
<li>
<p>'/run/systemd/system' - runtime changes that won&#8217;t persist</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>While the defaults for unit files won’t need to be altered most of the time, there will be circumstances where changing the defaults is quite beneficial. These could include hardware or software watchdog monitoring, tunings, resource management, or many other reasons.</p>
</div>
<div class="paragraph">
<p>Create a drop-in configuration file to extend the default httpd.service unit</p>
</div>
<div class="sect2">
<h3 id="_modify_httpd"><a class="anchor" href="#_modify_httpd"></a>Modify httpd</h3>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">workshop-systemd-httpdconfig.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>Contents of /etc/systemd/system/httpd.service.d/50-httpd.conf</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[Service]
Restart=always
OOMScoreAdjust=-1000</pre>
</div>
</div>
<div class="paragraph">
<p>OOMScoreAdjust is used by the Kernel&#8217;s Out Of Memory killer and is an  integer between -1000 (to disable OOM killing for this process) and 1000 (to make killing of this process under memory pressure very likely).</p>
</div>
<div class="paragraph">
<p>Notify systemd of the changes.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">systemctl daemon-reload</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_modify_mariadb"><a class="anchor" href="#_modify_mariadb"></a>Modify mariadb</h3>
<div class="paragraph">
<p>Similar to what you did in the last step, extend the mariadb.service unit with Restart=always.</p>
</div>
<div class="paragraph">
<p>This time we&#8217;ll use systemctl to create the drop-in and notify systemd of the changes.</p>
</div>
<div class="paragraph">
<p><code>systemctl edit</code> allows inserting the content for the drop-in and also handles the <code>systemctl daemon-reload</code> automatically.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
You must add your service customizations BETWEEN the commented lines near the top of the template, otherwise your update will be discarded
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Your edit should look like this before you save it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">### Editing /etc/systemd/system/mariadb.service.d/override.conf
### Anything between here and the comment below will become the new contents of the file

[Service]
Restart=always

### Lines below this comment will be discarded</pre>
</div>
</div>
<div class="paragraph">
<p>Proceed to make your changes now.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">systemctl edit mariadb</code></pre>
</div>
</div>
<div class="paragraph">
<p>Type (cut &amp; paste) the following using the automatically launched editor (vi) between the commented lines as outlined above:</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">[Service]
Restart=always</code></pre>
</div>
</div>
<div class="paragraph">
<p>Save and quit the editor, and view the unit</p>
</div>
<div class="paragraph">
<p><code>systemctl cat</code> is a quick and easy way to view the contents of a unit &amp; and it&#8217;s drop-ins.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">systemctl --no-pager cat mariadb</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">...snip...
# Restart crashed server only, on-failure would also restart, for example, when
# my.cnf contains unknown option
Restart=on-abort
RestartSec=5s

UMask=007

# Give a reasonable amount of time for the server to start up/shut down
TimeoutSec=300

# Place temp files in a secure directory, not /tmp
PrivateTmp=true

# /etc/systemd/system/mariadb.service.d/override.conf
[Service]
Restart=always</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_verify"><a class="anchor" href="#_verify"></a>Verify</h3>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">systemctl --no-pager status httpd</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">● httpd.service - The Apache HTTP Server
     Loaded: loaded (/usr/lib/systemd/system/httpd.service; enabled; preset: disabled)
    Drop-In: /etc/systemd/system/httpd.service.d
             └─50-httpd.conf
     Active: active (running) since Mon 2023-09-25 14:53:46 UTC; 5min ago
       Docs: man:httpd.service(8)
   Main PID: 36188 (httpd)
     Status: "Total requests: 0; Idle/Busy workers 100/0;Requests/sec: 0; Bytes served/sec:   0 B/sec"
      Tasks: 213 (limit: 22480)
     Memory: 33.3M
        CPU: 336ms
     CGroup: /system.slice/httpd.service
             ├─36188 /usr/sbin/httpd -DFOREGROUND
             ├─36233 /usr/sbin/httpd -DFOREGROUND
             ├─36238 /usr/sbin/httpd -DFOREGROUND
             ├─36239 /usr/sbin/httpd -DFOREGROUND
             └─36252 /usr/sbin/httpd -DFOREGROUND</pre>
</div>
</div>
<div class="paragraph">
<p>Notice that systemctl status displays that the unit has been extended with a drop-in file.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">systemctl --no-pager status mariadb</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">● mariadb.service - MariaDB 10.5 database server
     Loaded: loaded (/usr/lib/systemd/system/mariadb.service; enabled; preset: disabled)
    Drop-In: /etc/systemd/system/mariadb.service.d
             └─override.conf
     Active: active (running) since Mon 2023-09-25 14:53:48 UTC; 6min ago
       Docs: man:mariadbd(8)
             https://mariadb.com/kb/en/library/systemd/
   Main PID: 36509 (mariadbd)
     Status: "Taking your SQL requests now..."
      Tasks: 8 (limit: 22480)
     Memory: 73.1M
        CPU: 456ms
     CGroup: /system.slice/mariadb.service
             └─36509 /usr/libexec/mariadbd --basedir=/usr</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion"><a class="anchor" href="#_conclusion"></a>Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Hopefully you should now have a fundamental understanding of how services
are installed, managed and customized on Red Hat Enterprise Linux 9.</p>
</div>
<div class="paragraph">
<p>Time to finish this unit and return the shell to it&#8217;s home position.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">workshop-finish-exercise.sh</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_additional_resources"><a class="anchor" href="#_additional_resources"></a>Additional Resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can find more information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_basic_system_settings/introduction-to-systemd_configuring-basic-system-settings">Introduction to systemd</a></p>
</li>
</ul>
</div>
<h2 id="_end_of_unit" class="discrete">End of Unit</h2>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="webconsole.html" class="query-params-link">Web Console (cockpit)</a></span>
  <span class="next"><a href="firewalld.html" class="query-params-link">Firewall Management (firewalld)</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../../_/js/vendor/clipboard.js"></script>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
