<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: Definitive RHEL9 Workshop (v9.1)</title>
    <link rel="prev" href="firewalld.html">
    <link rel="next" href="ebpf.html">
    <meta name="generator" content="Antora 3.1.7">
    <link rel="stylesheet" href="../../_/css/site.css">
<link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://developers.redhat.com" target="_blank"><img
          src="../../_/img/header_logo.png" height="40px" alt="Red Hat Developer Program"></a>
      <a class="navbar-item" href="../..">Definitive RHEL9 Workshop (v9.1)</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Books</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">CheatSheets</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">CheatSheet A</a>
            <a class="navbar-item" href="#">CheatSheet B</a>
            <a class="navbar-item" href="#">CheatSheet C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Upcoming Events</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Event A</a>
            <a class="navbar-item" href="#">Event B</a>
            <a class="navbar-item" href="#">Event C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">More Tutorials</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Tutorial A</a>
            <a class="navbar-item" href="#">Tutorial B</a>
            <a class="navbar-item" href="#">Tutorial C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="modules" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html" class=" query-params-link">Default Title</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../overview.html">Workshop Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="webconsole.html">Web Console (cockpit)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="systemd.html">Service Management (systemd)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="firewalld.html">Firewall Management (firewalld)</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="nftables.html">Firewall Rules (nf-tables)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ebpf.html">eBPF Tracing (bcc-tools)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="podman.html">Containers Management (podman)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="buildah.html">Containers Dev (buildah)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="image-builder.html">Image Builder (composer-cli)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="virtualization.html">Virtualization (kvm,libvirt)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="tlog.html">Session Logging (tlog)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="lvm-vdo.html">Data Optimization (lvm,vdo)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="stratis.html">Storage Management (stratis)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="kpatch.html">Kernel Live Patching (kpatch)</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="boom-kernel-parms.html">Managing GRUB2 with Boom</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="leapp.html">LEAPP In-Place Upgrades</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Default Title</span>
    <span class="version">master</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Default Title</span>
      <ul class="versions">
        <li class="version is-current">
          <a href="../index.html">master</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../connection.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Default Title</a></li>
    <li><a href="nftables.html">Firewall Rules (nf-tables)</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="file:///Users/jmaltin/Development/RHEL9-Workshop-Showroom/content/modules/ROOT/pages/documentation/nftables.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<article class="doc">
<div class="sect1">
<h2 id="_introducing_nftables"><a class="anchor" href="#_introducing_nftables"></a>Introducing NFTables</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>NFTables is the subsystem of the Linux kernel which provides filtering and classification of network packets, datagrams, or frames. This software provides an in-kernel packet classification framework that is based on a network-specific Virtual Machine (VM) and a new nft userspace command line tool.</p>
</div>
<div class="paragraph">
<p>That is a lot of words to say: NFTables is a system that inspects network packets to and from your system, and based on a set of rules does something with those packets (ie: accept, deny, forward).</p>
</div>
<div class="paragraph">
<p>Primary benefits over the older system (iptables):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Better performance</p>
</li>
<li>
<p>Better usability</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started"><a class="anchor" href="#_getting_started"></a>Getting Started</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For these exercises, you will be using the host <code>node2</code> as user <code>root</code>.</p>
</div>
<div class="paragraph">
<p>From host <code>bastion</code>, ssh to <code>node2</code>.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">ssh node2</code></pre>
</div>
</div>
<div class="paragraph">
<p>Use <code>sudo</code> to elevate your privileges.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">[[ "$UID" == 0 ]] || sudo -i</code></pre>
</div>
</div>
<div class="paragraph">
<p>Verify that you are on the right host for these exercises.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">workshop-nftables-checkhost.sh</code></pre>
</div>
</div>
<h3 id="_disable_firewalld" class="discrete">Disable Firewalld</h3>
<div class="paragraph">
<p>For this unit, we also need to ensure firewalld is disabled.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">systemctl disable firewalld --now</code></pre>
</div>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">systemctl enable nftables --now</code></pre>
</div>
</div>
<div class="paragraph">
<p>You are now ready to proceed with these exercises.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_core_concepts"><a class="anchor" href="#_core_concepts"></a>Core Concepts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is not unusual for this subsystem of the linux kernel to get replaced from time to time.  You may be familiar with some of the prior filter systems:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ip-firewall (linux kernel v2.0, managed with ipfwadm)</p>
</li>
<li>
<p>ip-chains (linux kernel v2.2, managed with ipchains)</p>
</li>
<li>
<p>ip-tables (linux kernel v2.4, managed with iptables)</p>
</li>
<li>
<p>nf-tables (linux kernel v3.13, managed with nft)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There are others, but these are the most famliar ones that appeared in the major distributions.</p>
</div>
<div class="paragraph">
<p>In RHEL 9, you have a choice on how to implement and manage the firewall.  In which scenario should you use one of the following?</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>firewalld</strong>: easy to use and covers traditional firewall use cases</p>
</li>
<li>
<p><strong>nftables</strong>: for complex and performance critical firewalls</p>
</li>
<li>
<p><strong>iptables</strong>: the nf_tables API provides backward compatibility so that scripts that use iptables commands still work</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For 99% of all use cases the firewalld tools are the best choice.  For this lab however we are trying to introduce <code>nft</code> and demonstrate some differences to the former <code>iptables</code>.</p>
</div>
<div class="paragraph">
<p>Let us now being to understand the constructs that build the firewall rules: Tables, Chains &amp; Rules.</p>
</div>
<div class="sect2">
<h3 id="_tables"><a class="anchor" href="#_tables"></a>Tables</h3>
<div class="paragraph">
<p>Fundamentally speaking, filter rules are organized into chains and the chains are then further organized into tables.</p>
</div>
<div class="paragraph">
<p>Tables are the top-level construct within the nftables ruleset.</p>
</div>
<div class="paragraph">
<p>A table consists of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>chains</strong></p>
</li>
<li>
<p><strong>sets</strong></p>
</li>
<li>
<p><strong>maps</strong></p>
</li>
<li>
<p><strong>flowtables</strong></p>
</li>
<li>
<p><strong>stateful objects</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each table belongs to exactly one family:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>ip</strong> - IPv4</p>
</li>
<li>
<p><strong>ip6</strong> - IPv6</p>
</li>
<li>
<p><strong>inet</strong> - both IPv4 and IPv6</p>
</li>
<li>
<p><strong>arp</strong></p>
</li>
<li>
<p><strong>bridge</strong></p>
</li>
<li>
<p><strong>netdev</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So your ruleset requires at least one table for each family you want to filter.</p>
</div>
<div class="paragraph">
<p>Using nft, show the current state of the network tables.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">nft list tables</code></pre>
</div>
</div>
<div class="paragraph">
<p>There is nothing there, so let us create a new table called 'workshop'</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">nft add table inet workshop</code></pre>
</div>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">nft list tables</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">table inet workshop</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_chains"><a class="anchor" href="#_chains"></a>Chains</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Unlike in iptables, there are no predefined chains like INPUT, OUTPUT, etc.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A <strong>chain</strong> is a collection of attached <strong>rules</strong> that take action on network packets (ie: accept, drop).</p>
</div>
<div class="paragraph">
<p>Chain types are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>filter</strong> -  filters packets (supported by the arp, bridge, ip, ip6 and inet families)</p>
</li>
<li>
<p><strong>route</strong> - reroutes packets (supported by the ip, ip6 and inet families)</p>
</li>
<li>
<p><strong>nat</strong> -  performs Networking Address Translation (supported by the ip, ip6 and inet families)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Hooks you can use:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>ingress</strong> - sees packets immediately after passed up from NIC driver, before prerouting (only in netdev family since Linux kernel 4.2, and inet family since Linux kernel 5.10)</p>
</li>
<li>
<p><strong>prerouting</strong> : sees all incoming packets, before any routing decision has been made</p>
</li>
<li>
<p><strong>input</strong> : sees incoming packets that are addressed to and have now been routed to the local system</p>
</li>
<li>
<p><strong>forward</strong> : sees incoming packets that are not addressed to the local system</p>
</li>
<li>
<p><strong>output</strong> : sees packets that originated from processes in the local machine</p>
</li>
<li>
<p><strong>postrouting</strong> : sees all packets after routing, just before they leave the local system</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Using nft, show the current state of the network chains.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">nft list chains</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again there is nothing there, so let use create a new chain in our table called 'INPUT'.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
nft re-uses special characters (ie: curly braces and semicolons) so using single quotes is needed in this case
</td>
</tr>
</table>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">nft 'add chain inet workshop INPUT { type filter hook input priority 0 ; }'</code></pre>
</div>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs"><strong>nft list chains</strong></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">table inet workshop {
        chain INPUT {
                type filter hook input priority filter; policy accept;
        }
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rules"><a class="anchor" href="#_rules"></a>Rules</h3>
<div class="paragraph">
<p><strong>Rules</strong> take actions (ie: accept, drop, forward) on network packets based on specified criteria.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a rule consists of zero or more <strong>expressions</strong> followed by one or more <strong>statements</strong></p>
</li>
<li>
<p>each <strong>expression</strong> tests whether a packet matches a specific payload field or packet/flow metadata</p>
</li>
<li>
<p>if a packet matches all of the expressions in the rule, then rule&#8217;s <strong>statements</strong> are executed</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Using the Table and Chain created above, let&#8217;s proceed to implement and manage some basic rules.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_exercise_managing_rules"><a class="anchor" href="#_exercise_managing_rules"></a>Exercise: Managing Rules</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_add_single_rule"><a class="anchor" href="#_add_single_rule"></a>Add Single Rule</h3>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">nft insert rule inet workshop INPUT tcp dport http counter</code></pre>
</div>
</div>
<div class="paragraph">
<p>Verify the rule change.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">nft -n -a list table inet workshop</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">table inet workshop { # handle 2
        chain INPUT { # handle 1
                type filter hook input priority 0; policy accept;
                tcp dport 80 counter packets 0 bytes 0 # handle 4
        }
}</pre>
</div>
</div>
<div class="paragraph">
<p>Now is a good time to point out that the exercises in this unit are deliberately meant to be nondestructive.  Meaning, we don&#8217;t want this machine to be unusable due to an error in rule insertion or deletion.</p>
</div>
<div class="paragraph">
<p>So what does the previos rule do?  It merely counts packaets that arrived at port 80 on our machine.  Let&#8217;s send some packets.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">curl localhost</code></pre>
</div>
</div>
<div class="paragraph">
<p>There is no web server running on this system so you will get a failed connection message.  However, now we reexamine the counters.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">nft -n -a list table inet workshop</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">table inet workshop { # handle 2
        chain INPUT { # handle 1
                type filter hook input priority 0; policy accept;
                tcp dport 80 counter packets 2 bytes 140 # handle 4
        }
}</pre>
</div>
</div>
<div class="paragraph">
<p>Not too exciting, but now you know how to add a rule.</p>
</div>
</div>
<div class="sect2">
<h3 id="_delete_single_rule"><a class="anchor" href="#_delete_single_rule"></a>Delete Single Rule</h3>
<div class="paragraph">
<p>Deleting rules takes a little care in that you have to identify a <strong>handle</strong>.  Again, listing the rules make note of the <strong>handle</strong> provided next to each rule.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">nft -n -a list table inet workshop</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">table inet workshop { # handle 2
        chain INPUT { # handle 1
                type filter hook input priority 0; policy accept;
                tcp dport 80 counter packets 2 bytes 140 # <strong>handle 4</strong>
        }
}</pre>
</div>
</div>
<div class="paragraph">
<p>We can now use that <strong>handle</strong> to delete the rule.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">nft delete rule inet workshop INPUT handle 4</code></pre>
</div>
</div>
<div class="paragraph">
<p>Verify the rule change.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">nft -n -a list table inet workshop</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">table inet workshop { # handle 2
        chain INPUT { # handle 1
                type filter hook input priority 0; policy accept;
        }
}</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_add_multiple_rules_at_once"><a class="anchor" href="#_add_multiple_rules_at_once"></a>Add Multiple Rules at Once</h3>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">nft insert rule inet workshop INPUT tcp dport { ssh, http, https, 8181 } counter</code></pre>
</div>
</div>
<div class="paragraph">
<p>Verify the new rules.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">nft -n -a list table inet workshop</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">table inet workshop { # handle 2
        chain INPUT { # handle 1
                type filter hook input priority 0; policy accept;
                tcp dport { 22, 80, 443, 8181 } counter packets 10 bytes 712 # handle 6
        }
}</pre>
</div>
</div>
<div class="paragraph">
<p>Again, our chosen hook (counter) is meant primarily to be a nondestructive rule.  By using the <strong>input</strong> hook and applying the <strong>accept</strong> and <strong>drop</strong> policies, you get into the business of recreating a firewall.  Let&#8217;s go ahead and cleanup and restore firewalld and take one last look at the state of the system.</p>
</div>
</div>
<div class="sect2">
<h3 id="_cleanup"><a class="anchor" href="#_cleanup"></a>Cleanup</h3>
<div class="paragraph">
<p>Remove the chain added during this exercise.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">nft flush table inet workshop</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now delete the table</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">nft delete table inet workshop</code></pre>
</div>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">systemctl disable nftables --now</code></pre>
</div>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">systemctl enable firewalld --now</code></pre>
</div>
</div>
<div class="paragraph">
<p>And now check out how firewalld has built the ruleset in the netfilter.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">nft list tables</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">table inet firewalld</pre>
</div>
</div>
<div class="paragraph">
<p>Word of caution, the output here is long&#8230;&#8203;</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">nft -n -a list table inet firewalld</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">table inet firewalld { # handle 3
        chain mangle_PREROUTING { # handle 127
                type filter hook prerouting priority -140; policy accept;
                jump mangle_PREROUTING_ZONES # handle 131
        }

        chain mangle_PREROUTING_POLICIES_pre { # handle 128
                jump mangle_PRE_policy_allow-host-ipv6 # handle 297
        }

        chain mangle_PREROUTING_ZONES { # handle 129
                iifname "eth0" goto mangle_PRE_public # handle 306
                goto mangle_PRE_public # handle 261
        }

        chain mangle_PREROUTING_POLICIES_post { # handle 130
        }

        chain nat_PREROUTING { # handle 132
                type nat hook prerouting priority -90; policy accept;
                jump nat_PREROUTING_ZONES # handle 136
        }

&lt;... SNIP ...&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Now consider all of those rules to implement these basic firewall policies&#8230;&#8203;</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">firewall-cmd --list-all</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">public (active)
  target: default
  icmp-block-inversion: no
  interfaces: eth0
  sources:
  services: cockpit dhcpv6-client ssh
  ports:
  protocols:
  forward: yes
  masquerade: no
  forward-ports:
  source-ports:
  icmp-blocks:
  rich rules:</pre>
</div>
</div>
<div class="paragraph">
<p>Which is why we encourage you to use firewalld and firewall-cmd for 99% of your netfilter needs.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion"><a class="anchor" href="#_conclusion"></a>Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>That concludes this unit on nftables.</p>
</div>
<div class="paragraph">
<p>Time to finish this unit and return the shell to it&#8217;s home position.</p>
</div>
<div class="listingblock copy">
<div class="content">
<pre class="highlightjs highlight nowrap"><code class="language-none hljs">workshop-finish-exercise.sh</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_additional_resources"><a class="anchor" href="#_additional_resources"></a>Additional Resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can find more information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://netfilter.org/projects/nftables">Project Page</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Nftables">Wikipedia NFTables</a></p>
</li>
<li>
<p><a href="https://wiki.nftables.org/wiki-nftables/index.php/Main_Page">NFTables How-To</a></p>
</li>
<li>
<p><a href="https://wiki.nftables.org/wiki-nftables/index.php/Quick_reference-nftables_in_10_minutes">Quick Reference</a></p>
</li>
<li>
<p><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/configuring_firewalls_and_packet_filters/getting-started-with-nftables_firewall-packet-filters">Getting started with nftables</a></p>
</li>
</ul>
</div>
<h2 id="_end_of_unit" class="discrete">End of Unit</h2>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="firewalld.html" class="query-params-link">Firewall Management (firewalld)</a></span>
  <span class="next"><a href="ebpf.html" class="query-params-link">eBPF Tracing (bcc-tools)</a></span>
</nav>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <a class="rhd-logo" href="https://developers.redhat.com" target="_blank"></div>
</footer>
<script src="../../_/js/vendor/clipboard.js"></script>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
